edition: 3.0.0
name: yuefa-app
access: aliyun-fc

vars:
  region: cn-hangzhou

resources:
  yuefa-api:
    component: fc3
    props:
      region: ${vars.region}
      functionName: yuefa-api-prod
      description: YueFa API Server - Cosplay假发造型师工具
      runtime: nodejs18
      cpu: 0.5
      memorySize: 512
      diskSize: 512
      timeout: 60
      instanceConcurrency: 10
      handler: index.handler
      code: ./packages/server
      environmentVariables:
        NODE_ENV: production
        DATABASE_URL: ${env(DATABASE_URL)}
        JWT_SECRET: ${env(JWT_SECRET)}
        JWT_EXPIRES_IN: 7d
        OSS_ACCESS_KEY_ID: ${env(OSS_ACCESS_KEY_ID)}
        OSS_ACCESS_KEY_SECRET: ${env(OSS_ACCESS_KEY_SECRET)}
        OSS_BUCKET: ${env(OSS_BUCKET)}
        OSS_REGION: ${env(OSS_REGION)}
      triggers:
        - triggerName: http-trigger
          triggerType: http
          triggerConfig:
            authType: anonymous
            methods:
              - GET
              - POST
              - PUT
              - DELETE
              - PATCH
              - OPTIONS
            disableURLInternet: false
